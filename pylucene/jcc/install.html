<!-- jcc.html -->

<head>
  <!--
      Licensed to the Apache Software Foundation (ASF) under one or more
      contributor license agreements.  See the NOTICE file distributed with
      this work for additional information regarding copyright ownership.
      The ASF licenses this file to You under the Apache License, Version 2.0
      (the "License"); you may not use this file except in compliance with
      the License.  You may obtain a copy of the License at

         http://www.apache.org/licenses/LICENSE- 2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
  -->

  
    <link href="../../css/global.css" rel="stylesheet" type="text/css">
    <link href="../../css/pylucene.css" rel="stylesheet" type="text/css">

  <title>Apache Lucene - Install JCC</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
  <meta name="Distribution" content="Global"/>
  <meta name="Robots" content="index,follow"/>
  <meta name="keywords"
        content="apache, pylucene, jcc, lucene, apache pylucene, apache jcc,
  apache lucene, search, python search, information retrieval, spell checking, faceting, inverted index, open source"/>

  <link rel="shortcut icon" type="image/x-icon" href="/images/lucene-favicon.ico"/>
  
<script type="text/javascript" src="../../scripts/prototype.js"></script>
<script type="text/javascript" src="../../scripts/effects.js"></script>
<script type="text/javascript" src="../../scripts/search.js"></script>
<script type="text/javascript" src="../../scripts/slides.js"></script>

<!--<script type="text/javascript" src="scripts/jquery.js"></script>-->

</head>



<body id="home">
<div id="wrap">
  <div id="header">
    <div id="logo" style="float:left">
      
  <a href="index.html"><img border="0" src="../../images/lucene_logo_green_300.png"
                                            alt="Lucene Logo"/></a><div style="position:absolute;right:100px;top:10px"><span style="vertical-align: super; font-size: xx-small">TM</span></div>


    </div>
    <div id="search" style="float:right;zoom:1">
  <script type="text/javascript">
    function getBlank(input, stdValue) {
      if (input.value == stdValue) {
        input.value = '';
      }
      return true;
    }

    function submitForm(form) {
      provider = form.elements['searchProvider'].value;
      if (provider == "any") {
        if (Math.random() > 0.5) {
          provider = "lucid";
        } else {
          provider = "sl";
        }
      }

      if (provider == "lucid") {
        form.action = "http://find.searchhub.org/p:lucene,solr";
      } else if (provider == "sl") {
        form.action = "http://search-lucene.com/lucene";
      }

      days = 90; // cookie will be valid for 90 days
      date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      expires = "; expires=" + date.toGMTString();
      document.cookie = "searchProvider=" + provider + expires + "; path=/";

      return true;
    }
  </script>
  <form id="quick-search" method="GET" onsubmit="return submitForm(this)"
        action="http://search-lucene.com/lucene"
        name="searchform">
    <fieldset>
      <input type="search" id="q" name="q" value="Search with Apache Solr..." class="class1 class2 hint" accesskey="q"
             onfocus="getBlank(this, 'Search with Apache Solr...')">
      <span style="color:white">@</span>
      <select name="searchProvider" id="searchProvider">
        <option value="any">select provider</option>
        <option value="lucid">Lucid Find</option>
        <option value="sl">Search-Lucene</option>
      </select>
    </fieldset>
    <script type="text/javascript">
      if (document.cookie.length > 0) {
        cStart = document.cookie.indexOf("searchProvider=");
        if (cStart != -1) {
          cStart = cStart + "searchProvider=".length;
          cEnd = document.cookie.indexOf(";", cStart);
          if (cEnd == -1) {
            cEnd = document.cookie.length;
          }
          provider = unescape(document.cookie.substring(cStart, cEnd));
          document.forms['searchform'].elements['searchProvider'].value = provider;
        }
      }
    </script>
  </form>
</div>

    <div id="nav">
      
<ul>
  <li><a href="index.html">JCC</a></li>
  <li><a href="../mailing-lists.html">Mailing Lists</a></li>
  <li><a href="https://issues.apache.org/jira/browse/PYLUCENE">Issue Tracker</a></li>
  <li><a href="../index.html">PyLucene</a></li>
  <li><a class="last" href="../../index.html">Lucene</a></li>
</ul>

    </div>
    

  </div> 
  <div id="content-wrap" class="clearfix">
    <div id="main">
      <h1 class="title">Install JCC</h1>

      <div><style type="text/css">
/* The following code is added by mdx_elementid.py
   It was originally lifted from http://subversion.apache.org/style/site.css */
/*
 * Hide class="elementid-permalink", except when an enclosing heading
 * has the :hover property.
 */
.headerlink, .elementid-permalink {
  visibility: hidden;
}
h2:hover > .headerlink, h3:hover > .headerlink, h1:hover > .headerlink, h6:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, dt:hover > .elementid-permalink { visibility: visible }</style>
<h2 id="getting-jccs-source-code">Getting JCC's Source Code<a class="headerlink" href="#getting-jccs-source-code" title="Permanent link">&para;</a></h2>
<p>JCC's source code is included with PyLucene's. If you've downloaded
the PyLucene source code already, JCC's is to be found in
the <i>jcc</i> subdirectory.</p>
<p>To get the JCC source code only from SVN use:<br/>
<code>$ svn co
https://svn.apache.org/repos/asf/lucene/pylucene/trunk/jcc jcc</code></p>
<h2 id="building-jcc">Building JCC<a class="headerlink" href="#building-jcc" title="Permanent link">&para;</a></h2>
<p>JCC is a Python extension written in Python and C++. It requires a
Java Runtime Environment to operate as it uses Java's reflection
APIs to do its work. It is built and installed
via <i>distutils</i>
or <a href="https://pypi.python.org/pypi/setuptools">setuptools</a>.</p>
<ul>
<li>
<p>On MacOS and Windows, <i>setup.py</i> will attempt to find a JDK on your
system and report what it found by showing the values for <i>JAVAHOME</i> and
<i>JAVAFRAMEWORKS</i> it was able to derive. If the JDK installation that was
found is not the one you wish to use or if you are not on MacOS or Windows,
you can either edit <i>setup.py</i> and review that the values in the
<i>INCLUDES</i>, <i>CFLAGS</i>, <i>DEBUG_CFLAGS</i>, <i>LFLAGS</i>,
<i>JAVAC</i>, and <i>JAVADOC</i> dicts are correct for your system or set
<b>all</b> of the environment variables <i>JCC_JDK</i>, <i>JCC_INCLUDES</i>,
<i>JCC_CFLAGS</i>, <i>JCC_DEBUG_CFLAGS</i>, <i>JCC_LFLAGS</i>,
<i>JCC_JAVAC</i> and <i>JCC_JAVADOC</i>, using os.pathsep as value separator
to override them.
The values hereby configured are going to be compiled into JCC's
<i>config.py</i> file and are going to be used by JCC when invoking
<i>setuptools</i> to compile the extensions it is used to generate code for.</p>
</li>
<li>
<p>At the command line, enter:
<code>
$ python setup.py build<br/>
$ sudo python setup.py install<br/>
</code></p>
</li>
</ul>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h2>
<p>JCC requires a Java Development Kit to be present. It uses the Java
Native Invocation Interface and expects <i>&lt;jni.h&gt;</i>
and the Java libraries to be present at build and runtime.</p>
<p>JCC requires a C++ compiler. A recent C++ compiler for your
platform is expected to work as expected.</p>
<h2 id="shared-mode-support-for-the-shared-flag">Shared Mode: Support for the <i>--shared</i> Flag<a class="headerlink" href="#shared-mode-support-for-the-shared-flag" title="Permanent link">&para;</a></h2>
<p>JCC includes a small runtime that keeps track of the Java VM and of
Java objects escaping it. Because there can be only one Java VM
embedded in a given process at a time, the JCC runtime must be
compiled as a shared library when more than one JCC-built Python
extension is going to be imported into a given Python process.</p>
<p>Shared mode depends on <i>setuptools</i>' capability of
building plain shared libraries (as opposed to shared libraries for
Python extensions).</p>
<p>Currently, shared mode is supported with <i>setuptools 0.6c7</i> and above out
of the box on MacOS and Windows. On Linux, a patch to <i>setuptools</i> needs
to be applied first. This patch is included in the JCC source distribution in
the <i>jcc2/patches</i> directory, <i>patch.43</i>. This patch was submitted
to the <i>setuptools</i> project via <a
href="https://bugs.python.org/setuptools/issue43">issue 43</a>.
<i>setup.py</i> will attempt to apply the patch for you via monkeypatching.</p>
<p>The <i>shared mode disabled</i> error reported during the
build of JCC's on Linux contains the exact instructions on how to
patch the <i>setuptools</i> installation
with <i>patch.43</i> on your system.</p>
<p>Shared mode is also required when embedding Python in a Java VM as
JCC's runtime shared library is used by the JVM to load JCC and
bootstrap the Python VM via the JNI.</p>
<p>When shared mode is not enabled, not supported
or <i>distutils</i> is used instead
of <i>setuptools</i>, static mode is used instead. The JCC
runtime code is statically linked with each JCC-built Python
extension and only one such extension can be used in a given Python
process at a time.</p>
<p>As setuptools grows its shared library building capability it is
expected that more operating systems should be supported with shared
mode in the future.</p>
<p>Shared mode can be forced off by building JCC with
the <i>NO_SHARED</i> environment variable set.</p>
<p>There are two defaults to consider here:</p>
<ul>
<li>
<p>Is JCC built with shared mode support or not ?</p>
<ul>
<li>
<p>By default, on MacOS, Linux or Windows, this is the case when using a
  modern version of <i>setuptools</i></p>
</li>
<li>
<p>On other operating systems shared mode support is off by
  default - not supported - because shared mode depends on
  <i>setuptools</i>'s capability of building a regular
  shared library which is still an experimental feature.</p>
</li>
</ul>
</li>
<li>
<p>Is a JCC-built Python extension built with shared mode ?<br/>
    By default, no, shared mode is enabled only with
    the <i>--shared</i> command line argument.</p>
</li>
</ul>
<h2 id="notes-for-macos">Notes for MacOS<a class="headerlink" href="#notes-for-macos" title="Permanent link">&para;</a></h2>
<p>On MacOS, Java is installed by Apple's setup as a framework. The
values in <i>setup.py</i> for <i>INCLUDES</i>
and <i>LFLAGS</i> for <i>darwin</i> should be correct
and ready to use when <i>setup.py</i> was able to derive <i>JAVAHOME</i> and 
<i>JAVAFRAMEWORKS</i>.</p>
<p>However, if you intend to use the 'system' Python from a Java VM
  on MacOS -- Python embedded in Java --
  you will need to add the flags <i>"-framework", "Python"</i>
  to the <i>LFLAGS</i> value.</p>
<h2 id="notes-for-linux">Notes for Linux<a class="headerlink" href="#notes-for-linux" title="Permanent link">&para;</a></h2>
<p>JCC has been built and tested on a variety of Linux distributions,
32- and 64-bit. Getting the java configuration correct is important
and is done differently for every distribution.<br/>
For example:</p>
<ul>
<li>
<p>On Ubuntu, to install Java 5, these commands may be used:
<code>
      $ sudo apt-get install sun-java5-jdk<br/>
      $ sudo update-java-alternatives -s java-1.5.0-sun<br/>
</code>
The samples flags for Linux in JCC's setup.py should be close to
correct.</p>
</li>
<li>
<p>On Gentoo, the <i>java-config</i> utility should be used to
locate, and possibly change, the default java installation.
The sample flags for Linux in JCC's <i>setup.py</i> should
be changed to reflect the root of the Java installation which may
be obtained via:
<code>
      $ java-config -O
</code></p>
</li>
</ul>
<p>See earlier section about <a href="#shared">Shared Mode</a> for
Linux support.</p>
<h2 id="notes-for-solaris-11-with-sun-studio-c-12">Notes for Solaris 11 with Sun Studio C++ 12<a class="headerlink" href="#notes-for-solaris-11-with-sun-studio-c-12" title="Permanent link">&para;</a></h2>
<p>JCC has been built and tested on Solaris 11 with Sun Studio C++ 12, Java 1.6
and Python 2.4.</p>
<p>Because JCC is written in C++, Python's <i>distutils</i> must
be nudged a bit to invoke the correct compiler. Sun Studio's C
compiler is called <i>cc</i> while its C++ compiler is
called <i>CC</i>. To build JCC, use the following shell
command to ensure that the C++ compiler is used:</p>
<p><code>
$ CC=CC python setup.py build
</code></p>
<p>Shared mode is not currently implemented for
Solaris, <i>setuptools</i> needs to be taught how to build
plain shared libraries on Solaris first.</p>
<h2 id="notes-for-solaris-111-with-gcc-45">Notes for Solaris 11.1 with GCC 4.5<a class="headerlink" href="#notes-for-solaris-111-with-gcc-45" title="Permanent link">&para;</a></h2>
<p>JCC has been built and tested on Solaris 11.1 with gcc 4.5, Java 1.7 and
Python 2.6. Make sure, you?ve already installed the following packages:
gcc-4.5, jre-1.7, jdk-1.7, python-2.6, ant, gnu-make and subversion.</p>
<p>Missing packages can be installed via <i>pkg install</i>.</p>
<ul>
<li>Edit setup.py and do the following changes:                                <br />
Inside JDK = { ? } change the entry for sunos5 to:
<code>'sunos5': '/usr/jdk/instances/jdk1.7.0',</code>
Inside CFLAGS= {?} change the entry for sunos5 to:
<code>'sunos5': ['-fno-strict-aliasing', '-Wno-write-strings'],</code></li>
<li><code>python setup.py build</code></li>
<li><code>su python setup.py install</code></li>
</ul>
<h2 id="notes-for-windows">Notes for Windows<a class="headerlink" href="#notes-for-windows" title="Permanent link">&para;</a></h2>
<p>At this time, JCC has been built and tested on Win2k and WinXP with
a variety of Python and Java versions.</p>
<ul>
<li>
<p>Adding the Python directory to <i>PATH</i> is recommended.</p>
</li>
<li>
<p>Adding the Java directories containing the necessary DLLs and to
<i>PATH</i> is a must.</p>
</li>
<li>
<p>Adding the directory containing <i>javac.exe</i>
to <i>PATH</i> is required for shared mode (enabled by
default if <i>setuptools &gt;= 0.6c7</i> is found to be
installed).</p>
</li>
</ul>
<h2 id="notes-for-python-23">Notes for Python 2.3<a class="headerlink" href="#notes-for-python-23" title="Permanent link">&para;</a></h2>
<p>To use JCC with Python 2.3, setuptools is required</p>
<ul>
<li>
<p>download <a href="https://pypi.python.org/pypi/setuptools">setuptools</a>.</p>
</li>
<li>
<p>edit the downloaded <i>setuptools</i> egg file to use
python2.3 instead of python2.4.</p>
</li>
<li>
<p>At the command line, run:<br/>
<code>$ sudo sh setuptools-0.6c7-py2.4.egg</code></p>
</li>
</ul></div>
      


      
      <div><style type="text/css">
/* The following code is added by mdx_elementid.py
   It was originally lifted from http://subversion.apache.org/style/site.css */
/*
 * Hide class="elementid-permalink", except when an enclosing heading
 * has the :hover property.
 */
.headerlink, .elementid-permalink {
  visibility: hidden;
}
h2:hover > .headerlink, h3:hover > .headerlink, h1:hover > .headerlink, h6:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, dt:hover > .elementid-permalink { visibility: visible }</style>
<h2 id="the-apache-software-foundation">The Apache Software Foundation<a class="headerlink" href="#the-apache-software-foundation" title="Permanent link">&para;</a></h2>
<p>The <a href="http://www.apache.org">Apache Software Foundation</a> provides support for the Apache community of open-source software projects. The Apache projects are defined by collaborative consensus based processes, an open, pragmatic software license and a desire to create high quality software that leads the way in its field. Apache Lucene, Apache Solr, Apache PyLucene, Apache Open Relevance Project and their respective logos are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.</p></div>
      
    </div>
    
    <div id="sidebar">
      <style type="text/css">
/* The following code is added by mdx_elementid.py
   It was originally lifted from http://subversion.apache.org/style/site.css */
/*
 * Hide class="elementid-permalink", except when an enclosing heading
 * has the :hover property.
 */
.headerlink, .elementid-permalink {
  visibility: hidden;
}
h2:hover > .headerlink, h3:hover > .headerlink, h1:hover > .headerlink, h6:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, dt:hover > .elementid-permalink { visibility: visible }</style>
<h1 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="https://www.apache.org/licenses/">License</a></li>
<li><a href="features.html">Features</a></li>
<li><a href="install.html">Install</a></li>
</ul>
<h1 id="events">Events<a class="headerlink" href="#events" title="Permanent link">&para;</a></h1>
<ul>
<li><a  href="https://www.apache.org/events/current-event.html" target="_blank"><img src="https://www.apache.org/events/current-event-125x125.png"/></a></li>
</ul>
<h1 id="asf-links">ASF links<a class="headerlink" href="#asf-links" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="http://www.apache.org">Apache Software Foundation</a></li>
<li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
<li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
<li><a href="http://www.apache.org/security/">Security</a></li>
</ul>
<h1 id="related-projects">Related Projects<a class="headerlink" href="#related-projects" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="http://hadoop.apache.org">Apache Hadoop</a></li>
<li><a href="http://manifoldcf.apache.org/">Apache ManifoldCF</a></li>
<li><a href="http://lucenenet.apache.org/">Apache Lucene.Net</a></li>
<li><a href="http://lucy.apache.org/">Apache Lucy</a></li>
<li><a href="http://mahout.apache.org">Apache Mahout</a></li>
<li><a href="http://nutch.apache.org">Apache Nutch</a></li>
<li><a href="http://opennlp.apache.org/">Apache OpenNLP</a></li>
<li><a href="http://tika.apache.org">Apache Tika</a></li>
<li><a href="http://zookeeper.apache.org">Apache Zookeeper</a></li>
</ul>
    </div>

  </div>
  <div id="footer">
  <div class="copyright">
    <p>
      Copyright &copy; 2011-2019 The Apache Software Foundation, Licensed under
      the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.  <a href="/privacy.html">Privacy Policy</a>
      <br/>
      Apache and the Apache feather logo are trademarks of The Apache Software Foundation.  Apache Lucene, Apache Solr and their
      respective logos are trademarks of the Apache Software Foundation.  Please see the <a href="http://www.apache.org/foundation/marks/">Apache Trademark Policy</a>
      for more information.
    </p>
  </div>
</div>

</div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-94576-12']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>

